---
apiVersion: kuttl.dev/v1beta1
kind: TestAssert
metadata:
  name: test-env-overrides
commands:
  # Role level env var
  - script: kubectl exec -n $NAMESPACE -c opa svc/test-opa-https-server -- env | grep SERVER_ROLE_LEVEL_ENV_VAR
  - script: kubectl exec -n $NAMESPACE -c opa svc/test-opa-http-server -- env | grep SERVER_ROLE_LEVEL_ENV_VAR
  # RoleGroup level env var
  - script: kubectl exec -n $NAMESPACE -c opa svc/test-opa-https-server -- env | grep SERVER_ROLE_GROUP_LEVEL_ENV_VAR
  - script: kubectl exec -n $NAMESPACE -c opa svc/test-opa-http-server -- env | grep SERVER_ROLE_GROUP_LEVEL_ENV_VAR
